'***********************************
'Programa para el control del ganado
'Hecho por Juan Alfredo Hernández
'v1.0 08/03/2017
'***********************************
'Declaramos variables
Global VarProductor As Integer
Global VarHato As Integer
Global VarTipo As String
Global VarFecha As Date
Global VarFondo As String
Global VarTipoConexionProductor As Integer '1 Productor     2 Hato     3 Personal
'Declaramos las conexiones
Global BdConexion As New ADODB.Connection
'Declaramos los juegos de registros
Global BdRecordSet01 As New ADODB.Recordset
Global BdRecordSet02 As New ADODB.Recordset
Sub main()
    On Error GoTo ProcManejoErrores
    'Abrimos la conexión a la base de datos
    With BdConexion
        .CursorLocation = adUseClient
        .Open "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\JAHG Software\Control Bovino\BD\BD.mdb;Persist Security Info=False"
    End With
    'Inicializamos variables
    VarProductor = 0
    VarHato = 0
    VarTipoConexionProductor = 0
    'Abrimos el formulario principal
    With Form1
        .Show
    End With
    'Cargamos la imagen de fondo en el Picture
    ProcCargarFondo
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcActualizarFondo()
    On Error GoTo ProcManejoErrores
    'Abrimos la conexión
    With Form3
        With BdRecordSet01
            'Abrimos el juego de registros
            If .State = 1 Then .Close
            .Open "select * from Fondo", BdConexion
            .Requery
        End With
        With .DataGrid1
            Set .DataSource = BdRecordSet01
            'Actualizamos los campos con los valores de las variables
            .Columns(1) = VarFondo
            .Columns(2) = VarFecha
        End With
        With BdRecordSet01
            .Update
            'Cerramos la conexión
            .Close
        End With
    End With
    Unload Form3
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcActualizarProductores()
    On Error GoTo ProcManejoErrores
    'Actualizamos el registro
    actualizar = MsgBox("¿Desea actualizar el registro?", vbExclamation + vbYesNo, "Confirmación de actualización")
        If actualizar = vbYes Then
            With BdRecordSet02
                .Update
            End With
            ProcHabilitarBusqueda
            msg = MsgBox("Registro actualizado", vbOKOnly, "Terminado")
        End If
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcActualizacionTablas()
    On Error GoTo ProcManejoErrores
    With Form5
        With .Combo1
            If .Text = "Categoría" Then
                With BdRecordSet01
                    'Àbrimos la conexiòn a la base de datos
                    If .State = 1 Then .Close
                    .Open "select * from Categoria", BdConexion
                    .Requery
                End With
            Else
                If .Text = "Causa de aborto" Then
                     With BdRecordSet01
                        'Àbrimos la conexiòn a la base de datos
                        If .State = 1 Then .Close
                        .Open "select * from CausaAborto", BdConexion
                        .Requery
                    End With
                Else
                    If .Text = "Causa de no inseminar" Then
                            With BdRecordSet01
                                'Àbrimos la conexiòn a la base de datos
                                If .State = 1 Then .Close
                                .Open "select * from CausaNoInseminar", BdConexion
                                .Requery
                            End With
                    Else
                        If .Text = "Causa de rechazo" Then
                            With BdRecordSet01
                                'Àbrimos la conexiòn a la base de datos
                                If .State = 1 Then .Close
                                .Open "select * from CausaRechazo", BdConexion
                                .Requery
                            End With
                        Else
                            If .Text = "Diagnóstico de útero" Then
                                With BdRecordSet01
                                    'Àbrimos la conexiòn a la base de datos
                                    If .State = 1 Then .Close
                                    .Open "select * from DiagnosticoUtero", BdConexion
                                    .Requery
                                End With
                            Else
                                If .Text = "Enfermedad de ovario" Then
                                    With BdRecordSet01
                                        'Àbrimos la conexiòn a la base de datos
                                        If .State = 1 Then .Close
                                        .Open "select * from EnfermedadOvario", BdConexion
                                        .Requery
                                    End With
                                Else
                                    If .Text = "Enfermedad del útero" Then
                                        With BdRecordSet01
                                            'Àbrimos la conexiòn a la base de datos
                                            If .State = 1 Then .Close
                                            .Open "select * from EnfermedadUtero", BdConexion
                                            .Requery
                                        End With
                                    Else
                                        If .Text = "Especificaciones de la muerte" Then
                                            With BdRecordSet01
                                                'Àbrimos la conexiòn a la base de datos
                                                If .State = 1 Then .Close
                                                .Open "select * from EspecificacionesMuerte", BdConexion
                                                .Requery
                                            End With
                                        Else
                                            If .Text = "Especificaciones de venta" Then
                                                With BdRecordSet01
                                                    'Àbrimos la conexiòn a la base de datos
                                                    If .State = 1 Then .Close
                                                    .Open "select * from EspecificacionesVenta", BdConexion
                                                    .Requery
                                                End With
                                            Else
                                                If .Text = "Estado de la cría" Then
                                                    With BdRecordSet01
                                                        'Àbrimos la conexiòn a la base de datos
                                                        If .State = 1 Then .Close
                                                        .Open "select * from EstadoCria", BdConexion
                                                        .Requery
                                                    End With
                                                Else
                                                    If .Text = "Medicamentos de cuartos mamarios" Then
                                                       With BdRecordSet01
                                                            'Àbrimos la conexiòn a la base de datos
                                                            If .State = 1 Then .Close
                                                            .Open "select * from MedicacionCuartosMamarios", BdConexion
                                                            .Requery
                                                       End With
                                                    Else
                                                        If .Text = "Medicación Genital" Then
                                                            With BdRecordSet01
                                                                'Àbrimos la conexiòn a la base de datos
                                                                If .State = 1 Then .Close
                                                                .Open "select * from MedicacionGenital", BdConexion
                                                                .Requery
                                                            End With
                                                        Else
                                                            If .Text = "Medicamentos" Then
                                                                With BdRecordSet01
                                                                    'Àbrimos la conexiòn a la base de datos
                                                                    If .State = 1 Then .Close
                                                                    .Open "select * from Medicamento", BdConexion
                                                                    .Requery
                                                                End With
                                                            Else
                                                                If .Text = "Raza" Then
                                                                    With BdRecordSet01
                                                                        'Àbrimos la conexiòn a la base de datos
                                                                        If .State = 1 Then .Close
                                                                        .Open "select * from Raza", BdConexion
                                                                        .Requery
                                                                    End With
                                                                Else
                                                                    If .Text = "Resultado análisis" Then
                                                                        With BdRecordSet01
                                                                            'Àbrimos la conexiòn a la base de datos
                                                                            If .State = 1 Then .Close
                                                                            .Open "select * from ResultadoAnalisis", BdConexion
                                                                            .Requery
                                                                        End With
                                                                    Else
                                                                        If .Text = "Sexo cría" Then
                                                                            With BdRecordSet01
                                                                                'Àbrimos la conexiòn a la base de datos
                                                                                If .State = 1 Then .Close
                                                                                .Open "select * from SexoCria", BdConexion
                                                                                .Requery
                                                                            End With
                                                                        Else
                                                                            If .Text = "Tipo de análisis" Then
                                                                                With BdRecordSet01
                                                                                    'Àbrimos la conexiòn a la base de datos
                                                                                    If .State = 1 Then .Close
                                                                                    .Open "select * from TipoAnalisis", BdConexion
                                                                                    .Requery
                                                                                End With
                                                                            Else
                                                                                If .Text = "Tipo de enfermedad" Then
                                                                                    With BdRecordSet01
                                                                                        'Àbrimos la conexiòn a la base de datos
                                                                                        If .State = 1 Then .Close
                                                                                        .Open "select * from TipoEnfermedad", BdConexion
                                                                                        .Requery
                                                                                    End With
                                                                                Else
                                                                                    If .Text = "Tipo de parto" Then
                                                                                        With BdRecordSet01
                                                                                            'Àbrimos la conexiòn a la base de datos
                                                                                            If .State = 1 Then .Close
                                                                                            .Open "select * from TipoParto", BdConexion
                                                                                            .Requery
                                                                                        End With
                                                                                    Else
                                                                                        If .Text = "Via de Aplicación" Then
                                                                                           With BdRecordSet01
                                                                                                'Àbrimos la conexiòn a la base de datos
                                                                                                If .State = 1 Then .Close
                                                                                                .Open "select * from ViaAplicacion", BdConexion
                                                                                                .Requery
                                                                                            End With
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    End If
                                                                End If
                                                            End If
                                                        End If
                                                    End If
                                                End If
                                            End If
                                        End If
                                    End If
                                End If
                            End If
                        End If
                    End If
                End If
            End If
        End With
        .DataGrid1.Caption = .Combo1.Text
        With .DataGrid1
            'Asignamos la conexion al grid
            Set .DataSource = BdRecordSet01
        End With
        ProcResizeGrid
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcAsignaciones()
    On Error GoTo ProcManejoErrores
    If VarTipo = "Productores" Then
    'Ponemos el nombre del productor en un label
        With Form1
        'Condicional para productores
            With .Label2
                .Caption = "Productor: " + Form2.DataGrid1.Columns(1).Text
            End With
        End With
        With Form2
            With .DataGrid1
                'Ponemos el id del productor en un label
                VarProductor = .Columns(0).Value
            End With
        End With
    Else
        'Condicional para Hatos
        If VarTipo = "Hatos" Then
            'Ponemos el nombre del hato en un label
            With Form1
                With .Label3
                    .Caption = "Hato: " + Form2.DataGrid1.Columns(1).Text
                End With
                'Habilitamos Animales
                With .Animales
                    .Enabled = True
                End With
            End With
            'Ponemos el id del hato en un label
            With Form2
                With .DataGrid1
                    VarHato = .Columns(0).Value
                End With
            End With
        End If
    End If
    'Cerramos la conexiòn
    With BdRecordSet01
        .Close
    End With
    Unload Form2
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcBusquedaProductores()
    On Error GoTo ProcManejoErrores
    'Filtramos los registros segun el contenido del textbox
    With BdRecordSet02
        .Requery
        If option1.Value = True Then
            .Filter = "Nombre like '*" & Form4.Text9 & "*'"
        Else
            .Filter = ""
            .MoveFirst
        End If
    End With
    With Form4
        With .DataGrid3
            Set .DataSource = BdRecordSet02
        End With
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcCargarFondo()
    On Error GoTo ProcManejoErrores
    'Abrimos la conexión
    With BdRecordSet01
        If .State = 1 Then .Close
        .Open "select * from Fondo", BdConexion
        .Requery
    End With
    With Form3
        With .DataGrid1
            Set .DataSource = BdRecordSet01
            VarFondo = .Columns(1).Text
        End With
    End With
    With Form1
        With .Image1
            'Cambiamos la imagen de fondo
            .Picture = LoadPicture(VarFondo)
        End With
    End With
    'Cerramos la conexión
    With BdRecordSet01
        .Close
    End With
    Unload Form3
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcCerrarProductor()
    On Error GoTo ProcManejoErrores
    With Form1
        'Deshabilitamos animales
        With .Animales
            .Enabled = False
        End With
        'Limpiamos etiquetas
        With .Label2
            .Caption = ""
        End With
        With .Label3
            .Caption = ""
        End With
        'Inicializamos variables
        VarProductor = 0
        VarHato = 0
        'Inabilitamos el seleccionar hatos
        With .SeleccionarHato
            .Enabled = False
        End With
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcConexionAnimales()
    On Error GoTo ProcManejoErrores
    With Form6
        'Mostramos el Formulario
        .Show
        'Abrimos la conexion
        With BdRecordSet01
            If .State = 1 Then .Close
            .Open "select * from VAnimales where Productor = " & VarProductor & "and Hato = " & VarHato & "and Estado = 0", BdConexion  '0 Normal 1 Muerta 2 Vendida
            .Requery
        End With
        'Asignamos los datos al Grid
        With .DataGrid1
            Set .DataSource = .Adodc1
            .Caption = "General de animales"
            'Ocultamos columnas
            .Columns(0).Visible = False
            .Columns(1).Visible = False
            .Columns(9).Visible = False
        End With
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcConexionNuevoProductor()
    On Error GoTo ProcManejoErrores
    ProcLimpiarFormulario
    With Form4
        If VarTipoConexionProductor = 1 Then 'Productor
            .Caption = "Productores"
            'Abrimos las conexiones
            With BdRecordSet01
                If .State = 1 Then .Close
                .Open "select * from Productores", BdConexion
                .Requery
            End With
            With BdRecordSet02
                If .State = 1 Then .Close
                .Open "select * from Productores", BdConexion
                .Requery
            End With
            'Asignamos el juego de registros al grid
            With .DataGrid1
                Set .DataSource = BdRecordSet01
            End With
            With .DataGrid2
                Set .DataSource = BdRecordSet02
            End With
            ProcResizeGrid
            With .DataGrid3
                Set .DataSource = BdRecordSet02
                .Columns(2).Visible = False
                .Columns(3).Visible = False
                .Columns(4).Visible = False
            End With
            ProcResizeGrid
            'Asignamos los campos a los textbox
            With .Text4
                Set .DataSource = BdRecordSet02
                .DataField = "Nombre"
            End With
            With .Text5
                Set .DataSource = BdRecordSet02
                .DataField = "Direccion"
            End With
            With .Text6
                Set .DataSource = BdRecordSet02
                .DataField = "Ciudad"
            End With
        Else
            If VarTipoConexionProductor = 2 Then 'Hatos
                .Caption = "Hatos de " + Form1.Label2.Caption
                'Abrimos las conexiones
                With BdRecordSet01
                    If .State = 1 Then .Close
                    .Open "select * from Hatos where productor = " & VarProductor, BdConexion
                    .Requery
                End With
                With BdRecordSet02
                    If .State = 1 Then .Close
                    .Open "select * from Hatos where productor = " & VarProductor, BdConexion
                    .Requery
                End With
                'Asignamos el juego de registros al grid
                With .DataGrid1
                    Set .DataSource = BdRecordSet01
                End With
                With .DataGrid2
                    Set .DataSource = BdRecordSet02
                End With
                With .DataGrid3
                    Set .DataSource = BdRecordSet02
                    .Columns(1).Visible = False
                    .Columns(3).Visible = False
                    .Columns(4).Visible = False
                    .Columns(5).Visible = False
                End With
                ProcResizeGrid
                'Asignamos los campos a los textbox
                With .Text4
                    Set .DataSource = BdRecordSet02
                    .DataField = "Nombre"
                End With
                With .Text5
                    Set .DataSource = BdRecordSet02
                    .DataField = "Direccion"
                End With
                With .Text6
                    Set .DataSource = BdRecordSet02
                    .DataField = "Ciudad"
                End With
            Else
                If VarTipoConexionProductor = 3 Then 'Personal
                    .Caption = "Personal de " + Form1.Label2.Caption
                    'Abrimos las conexiones
                    With BdRecordSet01
                        If .State = 1 Then .Close
                        .Open "select * from Personal where productor = " & VarProductor, BdConexion
                        .Requery
                    End With
                    With BdRecordSet02
                        If .State = 1 Then .Close
                        .Open "select * from Personal where productor = " & VarProductor, BdConexion
                        .Requery
                    End With
                    'Asignamos el juego de registros al grid
                    With .DataGrid1
                        Set .DataSource = BdRecordSet01
                    End With
                    With .DataGrid2
                        Set .DataSource = BdRecordSet02
                    End With
                    With .DataGrid3
                        Set .DataSource = BdRecordSet02
                        .Columns(1).Visible = False
                        .Columns(3).Visible = False
                        .Columns(4).Visible = False
                        .Columns(5).Visible = False
                    End With
                    ProcResizeGrid
                    'Asignamos los campos a los textbox
                    With .Text4
                        Set .DataSource = BdRecordSet02
                        .DataField = "Nombre"
                    End With
                    With .Text5
                        Set .DataSource = BdRecordSet02
                        .DataField = "Direccion"
                    End With
                    With .Text6
                        Set .DataSource = BdRecordSet02
                        .DataField = "Ciudad"
                    End With
                End If
            End If
        End If
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcEliminarProductor()
    On Error GoTo ProcManejoErrores
    With Form4
        eliminar = MsgBox("¿Desea eliminar el registro?", vbExclamation + vbYesNo, "Confirmación de eliminación")
        If eliminar = vbYes Then
            With BdRecordSet01
                'Eliminamos el registro
                .Delete
                .Requery
            End With
            ProcHabilitarBusqueda
            msg = MsgBox("Registro eliminado", vbOKOnly, "Terminado")
        End If
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcEliminarValoresTabla()
    On Error GoTo ProcManejoErrores
    With Form5
        eliminar = MsgBox("¿Desea eliminar el registro?", vbExclamation + vbYesNo, "Confirmación de eliminación")
        If eliminar = vbYes Then
            With BdRecordSet01
                'Eliminamos el registro
                .Delete
                .Requery
            End With
            With .DataGrid1
                .SetFocus
            End With
            msg = MsgBox("Registro eliminado", vbOKOnly, "Terminado")
        End If
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcFormResize()
    On Error GoTo ProcManejoErrores
    With Form1
        'Posicionamos reloj
        With .Label1
            .Left = Form1.Width - 3345
            .Top = Form1.Height - 1275
        End With
        'Redimensionamos el fondo
        With .Image1
            .Width = Form1.Width
            .Height = Form1.Height
        End With
        'Establecemos tamaño mìnimo del formulario
        If .Width < 5760 Then
            .Width = 5760
        End If
        If .Height < 5475 Then
            .Height = 5475
        End If
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcHabilitarBusqueda()
    On Error GoTo ProcManejoErrores
    With Form4
        'Habilitamos el frame de búsqueda
        With .Frame1
            .Visible = False
        End With
        With .Frame2
            .Visible = False
        End With
        With .Frame3
            .Visible = True
        End With
        With .Text9
            .Text = ""
            .SetFocus
        End With
        With .Command1
            .Enabled = False
        End With
        With .Command2
            .Enabled = False
        End With
    End With
    BdRecordSet02.Requery
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcHabilitarHato()
    On Error GoTo ProcManejoErrores
    With Form1
        'Habilitamos la selecciòn de un Hato, Dar de Alta Hatos y personal si ya se seleccionò el productor
        If Label2.Caption = "" Then
            With .Label3
                .Caption = ""
            End With
            VarHato = 0
            With .SeleccionarHato
                .Enabled = False
            End With
            With .Hato
                .Enabled = False
            End With
            With .Personal
                .Enabled = False
            End With
        Else
            With .SeleccionarHato
                .Enabled = True
            End With
            With .Hato
                .Enabled = True
            End With
            With .Personal
                .Enabled = True
            End With
        End If
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcHatos()
    On Error GoTo ProcManejoErrores
    VarTipoConexionProductor = 2 'Hatos
    ProcConexionNuevoProductor
 'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
End Sub
Sub ProcInsertarProductor()
    On Error GoTo ProcManejoErrores
    With Form4
        With BdRecordSet01
            If VarTipoConexionProductor = 1 Then 'Productor
                insertar = MsgBox("¿Desea guardar el registro?", vbExclamation + vbYesNo, "Confirmación")
                'Insertamos el registro
                If insertar = vbYes Then
                    .AddNew
                    .Fields("Nombre") = Form4.Text1.Text
                    .Fields("Direccion") = Form4.Text2.Text
                    .Fields("Ciudad") = Form4.Text3.Text
                    .Fields("Creacion") = VarFecha
                    .Update
                    msg = MsgBox("Registro guardado correctamente", vbOKOnly, "Terminado")
                End If
            Else
                If VarTipoConexionProductor = 2 Then 'Hatos
                    insertar = MsgBox("¿Desea guardar el registro?", vbExclamation + vbYesNo, "Confirmación")
                    'Insertamos el registro
                    If insertar = vbYes Then
                        .AddNew
                        .Fields("Productor") = VarProductor
                        .Fields("Nombre") = Form4.Text1.Text
                        .Fields("Direccion") = Form4.Text2.Text
                        .Fields("Ciudad") = Form4.Text3.Text
                        .Fields("Creacion") = VarFecha
                        .Update
                        msg = MsgBox("Registro guardado correctamente", vbOKOnly, "Terminado")
                    End If
                Else
                    If VarTipoConexionProductor = 3 Then 'Personal
                        insertar = MsgBox("¿Desea guardar el registro?", vbExclamation + vbYesNo, "Confirmación")
                        'Insertamos el registro
                        If insertar = vbYes Then
                            .AddNew
                            .Fields("Productor") = VarProductor
                            .Fields("Nombre") = Form4.Text1.Text
                            .Fields("Direccion") = Form4.Text2.Text
                            .Fields("Ciudad") = Form4.Text3.Text
                            .Fields("Creacion") = VarFecha
                            .Update
                            msg = MsgBox("Registro guardado correctamente", vbOKOnly, "Terminado")
                        End If
                    End If
                End If
            End If
        End With
    End With
    ProcMostrarAgregarProductores
    With Form1
        'Deshabilitamos animales
        With .Animales
            .Enabled = False
        End With
        'Limpiamos etiquetas
        With .Label2
            .Caption = ""
        End With
        With .Label3
            .Caption = ""
        End With
        'Inicializamos variables
        VarProductor = 0
        VarHato = 0
        'Inabilitamos el seleccionar hatos
        With .SeleccionarHato
            .Enabled = False
        End With
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcLimpiarFormulario()
    On Error GoTo ProcManejoErrores
    With Form4
        'Inhabilitamos frames
        With .Frame1
            .Visible = False
        End With
        With .Frame2
            .Visible = False
        End With
        With .Frame3
            .Visible = True
        End With
        .Show
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcListarTablas()
    On Error GoTo ProcManejoErrores
    With Form5
        With .Combo1
            'Agregamos valores al combobox
            .AddItem ("Categoría")
            .AddItem ("Causa de aborto")
            .AddItem ("Causa de no inseminar")
            .AddItem ("Causa de rechazo")
            .AddItem ("Diagnóstico de útero")
            .AddItem ("Enfermedad de ovario")
            .AddItem ("Enfermedad del útero")
            .AddItem ("Especificaciones de la muerte")
            .AddItem ("Especificaciones de venta")
            .AddItem ("Estado de la cría")
            .AddItem ("Medicamentos de cuartos mamarios")
            .AddItem ("Medicación Genital")
            .AddItem ("Medicamentos")
            .AddItem ("Razas")
            .AddItem ("Resultado análisis")
            .AddItem ("Sexo cría")
            .AddItem ("Tipo de análisis")
            .AddItem ("Tipo de enfermedad")
            .AddItem ("Tipo de parto")
            .AddItem ("Via de Aplicación")
        End With
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcMostrarAgregarProductores()
    On Error GoTo ProcManejoErrores
    With Form4
        'Mostramos frame para insertar registro
        With .Frame1
            .Visible = True
        End With
        With .Frame2
            .Visible = False
        End With
        With .Frame3
            .Visible = False
        End With
        With .Text1
            .Text = ""
            .SetFocus
        End With
        With .Text2
            .Text = ""
        End With
        With .Text3
            .Text = ""
        End With
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcPersonales()
    On Error GoTo ProcManejoErrores
    VarTipoConexionProductor = 3 'Personal
    ProcConexionNuevoProductor
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcProductores()
    On Error GoTo ProcManejoErrores
    VarTipoConexionProductor = 1 'Productor
    ProcConexionNuevoProductor
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcReloj()
    On Error GoTo ProcManejoErrores
    VarFecha = Date + Time
    With Form1
        With .Label1
            .Caption = VarFecha 'Reloj del Sistema
        End With
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcResizeGrid()
    On Error GoTo ProcManejoErrores
    'Ajustamos el tamaño de las columnas de los diferentes grid
    With Form2
        With .DataGrid1
            'Cambiamos el tamaño de las columnas del grid en el form2
            .Columns(0).Width = 500
            .Columns(1).Width = 5300
        End With
    End With
    With Form4
        With .DataGrid3
            .Columns(0).Width = 500
            .Columns(1).Width = 5150
        End With
    End With
    With Form5
        With .DataGrid1
            'Cambiamos el tamaño de las columnas del grid en el form2
            .Columns(0).Width = 700
            .Columns(1).Width = 5100
            .Columns(2).Width = 1400
        End With
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcRespaldar()
    On Error GoTo ProcManejoErrores
    ProcSalirRespaldarRestaurar
    'Abrimos el cuadro de diálogo
    With Form1
        With .CommonDialog1
            .DialogTitle = "Guardar Respaldo"
            .Filter = "Respaldos|*.jahg"
            .InitDir = "C:\JAHG Software\Control Bovino\Respaldos"
            .ShowSave
            'Copiamos el archivo respaldo
            If .FileName = "" Then
            Else
                FileCopy "C:\JAHG Software\Control Bovino\BD\BD.mdb", .FileName
                msg = MsgBox("Respaldo terminado", vbOKOnly, "Terminado")
            End If
        End With
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcRestaurar()
    On Error GoTo ProcManejoErrores
    ProcSalirRespaldarRestaurar
    'Abrimos el cuadro de diálogo
    With Form1
        With .CommonDialog1
            .DialogTitle = "Seleccionar Respaldo"
            .Filter = "Respaldos|*.jahg"
            .InitDir = "C:\JAHG Software\Control Bovino\Respaldos"
            .ShowOpen
            'Copiamos el archivo respaldo
            If .FileName = "" Then
            Else
                FileCopy .FileName, "C:\JAHG Software\Control Bovino\BD\BD.mdb"
                msg = MsgBox("Restauración terminada", vbOKOnly, "Terminado")
                main
            End If
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcResultadoBusquedaProductores()
    On Error GoTo ProcManejoErrores
    With Form4
        'Mostramos los resultados de la búsqueda
        With .Frame1
            .Visible = False
        End With
        With .Frame2
            .Visible = True
        End With
        With .Frame3
            .Visible = False
        End With
        With .Text4
            .SetFocus
        End With
        With .Command1
            .Enabled = True
        End With
        With .Command2
            .Enabled = True
        End With
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcSalir()
    On Error GoTo ProcManejoErrores
    'Cerramos todos los formularios
    Unload Form6
    Unload Form5
    Unload Form4
    Unload Form3
    Unload Form2
    Unload Form1
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcSalirRespaldarRestaurar()
    On Error GoTo ProcManejoErrores
    'Cerramos formularios para respaldar/restaurar
    Unload Form6
    Unload Form5
    Unload Form4
    Unload Form3
    Unload Form2
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcSeleccionHato()
    On Error GoTo ProcManejoErrores
    With Form1
        'Deshabilitamos animales
        With .Animales
            .Enabled = False
        End With
        'Limpiamos etiqueta
        With .Label3
            .Caption = ""
        End With
    End With
    VarHato = 0
    With Form2
        'Cambiamos el nombre del form2
        .Show
        .Caption = "Hatos de " + Form1.Label2.Caption
    End With
    'Asignamos valor a la variable
    VarTipo = "Hatos"
    'Àbrimos la conexiòn a la base de datos y se la asignamos al grid
    With BdRecordSet01
        If .State = 1 Then .Close
        .Open "select * from Hatos where productor = " & VarProductor, BdConexion
        .Requery
    End With
    With Form2
        With .DataGrid1
            .DataSource = BdRecordSet01
        End With
    End With
    ProcResizeGrid
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcSeleccionarImagenFondo()
    On Error GoTo ProcManejoErrores
    With Form1
        With .CommonDialog1
            'Abrimos el cuadro de diálogo
            .DialogTitle = "Seleccionar una Imagen de Fondo"
            .Filter = "Imágenes|*.jpg"
            .InitDir = "c:\%UserProfile%\Pictures"
            .ShowOpen
            'Asignamos la ruta a la variable
            VarFondo = .FileName
            If .FileName = "" Then
            Else
                ProcActualizarFondo
                ProcCargarFondo
            End If
        End With
    End With
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub
Sub ProcSeleccionProductor()
    On Error GoTo ProcManejoErrores
    With Form1
        'Deshabilitamos animales
        With .Animales
            .Enabled = False
        End With
        'Limpiamos etiquetas
        With .Label2
            .Caption = ""
        End With
        With .Label3
            .Caption = ""
        End With
        'Inicializamos variables
        VarProductor = 0
        VarHato = 0
        'Inabilitamos el seleccionar hatos
        With .SeleccionarHato
            .Enabled = False
        End With
    End With
    With Form2
        'Cambiamos el nombre del form2
        .Show
        .Caption = "Productores"
        'Asignamos valor a la variable
        VarTipo = "Productores"
        'Àbrimos la conexiòn a la base de datos y se la asignamos al grid
        With BdRecordSet01
            If .State = 1 Then .Close
            .Open "select Id,Nombre from Productores", BdConexion
            .Requery
        End With
        With .DataGrid1
            .DataSource = BdRecordSet01
        End With
    End With
    ProcResizeGrid
'Capturamos errores y los mostramos
ProcManejoErrores:
    MsgBox ("Se ha producido un error. Tipo de error = " & Err.Number & ". Descripción: " & Err.Description)
End Sub